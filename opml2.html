<html><head><title>live list editor</title>
<style type="text/css">
.item_text {
    background: #ccc;
}
.item {
    background: #cfc;
    padding-left: 1em;
    padding-right: 1em;
    border: 1px solid black;
}
.selected {
    border: 1px solid red;
}
</style>
<script lang="text/javascript">


//////////////////////////////////////////////////////////////////////////////
// manipulating items

function remove_item(item) {
    var pa = item.parentNode;
    pa.removeChild(item);
}

function newitem(text) {
    var li = document.createElement("li");
    var a = document.createElement("a");
    a.href = '#';
    a.appendChild(document.createTextNode("x"));
    a.addEventListener("click", function () {
        remove_item(li);
    }, false);
    li.appendChild(document.createTextNode(text + ' '));
    li.appendChild(a);
    li.addEventListener("click", function() {
        select_item(li);
    }, false);
    li.setAttribute("class", "item");
    return li;
}

function additem(text) {
    var list = document.getElementById("mainlist");
    var item = newitem(text);
    list.appendChild(item);
    debug("new item added");
    select_item(item);
}

function deselect_all_items() {
    var list = document.getElementById("mainlist");
    debug(list.childNodes.length);
    for(var child = list.firstChild; null != child; child = child.nextSibling) {
        if(child.setAttribute) {
            child.setAttribute("class", "item");
            debug(child.getAttribute("class"));
        } // could be text node?
    }
}

function select_item(item) {
    deselect_all_items();
    item.setAttribute("class", "selected item");
}

//////////////////////////////////////////////////////////////////////////////
// global event hooks and functions

function additem_button() {
    additem("new item");
}

function list_startup() {
    additem("first item");
    debug("lift-off");
}

function debug(text) {
    document.getElementById("debugarea").value = text;
}

</script>

</head>
<body id="thebody" onload="list_startup()";>
<ul id="mainlist">
</ul>
<input type="submit" onclick="debugme();" value="debugme" />
<input type="submit" onclick="additem_button();" value="new item" />
<hr />
<input type="text" value="debugarea" id="debugarea" />

</body></html>
